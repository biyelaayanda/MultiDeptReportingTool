# Authentication Hardening Tests

## Test Refresh Token Flow

### 1. Login Test
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "finance-staff",
  "password": "Finance123!"
}

### 2. Refresh Token Test
POST {{baseUrl}}/api/auth/refresh-token
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### 3. Revoke Token Test
POST {{baseUrl}}/api/auth/revoke-token
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### 4. Logout All Devices Test
POST {{baseUrl}}/api/auth/logout-all-devices
Authorization: Bearer {{accessToken}}

### 5. Logout Test
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{accessToken}}

## Test Rate Limiting
### Multiple Failed Login Attempts
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "finance-staff",
  "password": "wrongpassword"
}

## Variables
@baseUrl = http://localhost:5000
@accessToken = 
@refreshToken = 
